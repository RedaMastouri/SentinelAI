rule Suspicious_JavaScript {
    meta:
        description = "Detects suspicious JavaScript code patterns"
        severity = 3
        category = "malware"
    strings:
        $eval = "eval(" nocase
        $document_write = "document.write" nocase
        $innerHTML = "innerHTML" nocase
        $localStorage = "localStorage" nocase
        $sessionStorage = "sessionStorage" nocase
        $fetch = "fetch(" nocase
        $xmlhttp = "XMLHttpRequest" nocase
        $websocket = "WebSocket" nocase
    condition:
        any of ($eval, $document_write, $innerHTML, $localStorage, $sessionStorage, $fetch, $xmlhttp, $websocket)
}

rule Suspicious_Shell_Commands {
    meta:
        description = "Detects suspicious shell commands"
        severity = 3
        category = "malware"
    strings:
        $cmd = "cmd.exe" nocase
        $powershell = "powershell" nocase
        $bash = "bash" nocase
        $sh = "sh" nocase
        $curl = "curl" nocase
        $wget = "wget" nocase
    condition:
        any of ($cmd, $powershell, $bash, $sh, $curl, $wget)
}

rule Suspicious_File_Operations {
    meta:
        description = "Detects suspicious file operations"
        severity = 2
        category = "malware"
    strings:
        $file_upload = "FileUpload" nocase
        $file_download = "FileDownload" nocase
        $file_system = "FileSystem" nocase
        $file_stream = "FileStream" nocase
    condition:
        any of ($file_upload, $file_download, $file_system, $file_stream)
}

rule Sensitive_Data_Exposure {
    meta:
        description = "Detects potential sensitive data exposure"
        severity = 2
        category = "data_leak"
    strings:
        $credit_card = /\b\d{4}[- ]?\d{4}[- ]?\d{4}[- ]?\d{4}\b/
        $ssn = /\b\d{3}[-]?\d{2}[-]?\d{4}\b/
        $email = /\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b/
        $password = "password" nocase
        $token = "token" nocase
        $api_key = "api_key" nocase
    condition:
        any of ($credit_card, $ssn, $email, $password, $token, $api_key)
}

rule Jailbreak_Attempt {
    meta:
        description = "Detects potential jailbreak attempts"
        severity = 3
        category = "security"
    strings:
        $ignore = "ignore previous instructions" nocase
        $free = "you are now free" nocase
        $pretend = "pretend you are" nocase
        $bypass = "bypass" nocase
        $hack = "hack" nocase
        $exploit = "exploit" nocase
    condition:
        any of ($ignore, $free, $pretend, $bypass, $hack, $exploit)
} 